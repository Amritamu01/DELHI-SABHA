<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DELHI SIM - Digital Democracy</title>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { 
            getAuth, 
            createUserWithEmailAndPassword, 
            signInWithEmailAndPassword, 
            signOut,
            onAuthStateChanged 
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        
        import { 
            getFirestore, 
            collection, 
            addDoc, 
            getDocs,
            getDoc,
            doc,
            setDoc,
            updateDoc,
            query,
            where,
            orderBy,
            serverTimestamp 
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCBVXhX11_8___T1NzDPwGPXZxLYl8VuF4",
            authDomain: "politics-fd465.firebaseapp.com",
            databaseURL: "https://politics-fd465-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "politics-fd465",
            storageBucket: "politics-fd465.firebasestorage.app",
            messagingSenderId: "506429417906",
            appId: "1:506429417906:web:0196c57945e2d289895cab"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Global Variables
        let currentUser = null;
        let userData = null;
        let theme = 'light';
        let electionEndDate = new Date();
        electionEndDate.setDate(electionEndDate.getDate() + 30);

        // Initialize App
        document.addEventListener('DOMContentLoaded', async function() {
            // Check saved theme
            const savedTheme = localStorage.getItem('delhiSimTheme');
            if (savedTheme) {
                theme = savedTheme;
                setTheme(theme);
            }
            
            // Initialize election timer
            initializeElectionTimer();
            
            // Show India Gate animation after 3 seconds on home page
            setTimeout(() => {
                if (document.getElementById('dashboardPage').classList.contains('active')) {
                    showIndiaGateAnimation();
                }
            }, 3000);
            
            // Auth state listener
            onAuthStateChanged(auth, async (user) => {
                currentUser = user;
                if (user) {
                    await loadUserData(user.uid);
                    showAnimation();
                    setTimeout(() => {
                        hideAnimation();
                        showDashboard();
                    }, 3000);
                } else {
                    showLogin();
                }
            });

            setupEventListeners();
        });

        // India Gate Animation
        function showIndiaGateAnimation() {
            const indiaGate = document.getElementById('indiaGateAnimation');
            indiaGate.style.display = 'flex';
            setTimeout(() => {
                indiaGate.style.opacity = '1';
                indiaGate.style.transform = 'translateY(0)';
            }, 100);
            
            setTimeout(() => {
                indiaGate.style.opacity = '0';
                indiaGate.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    indiaGate.style.display = 'none';
                }, 500);
            }, 5000);
        }

        // Animation Functions
        function showAnimation() {
            document.getElementById('welcomeAnimation').style.display = 'flex';
            const logo = document.getElementById('animationLogo');
            logo.classList.remove('animate');
            void logo.offsetWidth;
            logo.classList.add('animate');
        }

        function hideAnimation() {
            document.getElementById('welcomeAnimation').style.display = 'none';
        }

        // Theme Functions
        function setTheme(newTheme) {
            theme = newTheme;
            localStorage.setItem('delhiSimTheme', newTheme);
            document.body.setAttribute('data-theme', newTheme);
        }

        // Load User Data - FIXED VERSION
        async function loadUserData(uid) {
            try {
                const userDocRef = doc(db, "users", uid);
                const userDoc = await getDoc(userDocRef);
                
                if (userDoc.exists()) {
                    userData = userDoc.data();
                    console.log("User data loaded:", userData);
                } else {
                    // Create new user document
                    userData = {
                        uid: uid,
                        email: currentUser.email,
                        name: currentUser.displayName || "",
                        groupId: null,
                        isLeader: false,
                        createdAt: serverTimestamp(),
                        lastActive: serverTimestamp()
                    };
                    await setDoc(userDocRef, userData);
                    console.log("New user created:", userData);
                }
                
                // Update profile display immediately
                updateProfileDisplay();
                
            } catch (error) {
                console.error("Error loading user data:", error);
                showNotification('Error loading profile data', 'error');
            }
        }

        function setupEventListeners() {
            // Login Form
            document.getElementById('loginForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                
                try {
                    await signInWithEmailAndPassword(auth, email, password);
                    showNotification('Login successful!', 'success');
                } catch (error) {
                    showNotification('Login failed: ' + getErrorMessage(error.code), 'error');
                }
            });

            // Signup Form - FIXED VERSION
            document.getElementById('signupForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('signupEmail').value;
                const password = document.getElementById('signupPassword').value;
                const name = document.getElementById('signupName').value;
                
                if (password.length < 6) {
                    showNotification('Password must be at least 6 characters', 'error');
                    return;
                }
                
                try {
                    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                    
                    // Create user document in Firestore
                    const userRef = doc(db, "users", userCredential.user.uid);
                    await setDoc(userRef, {
                        name: name,
                        email: email,
                        groupId: null,
                        isLeader: false,
                        createdAt: serverTimestamp(),
                        lastActive: serverTimestamp()
                    });
                    
                    showNotification('Account created successfully!', 'success');
                    
                    // Show animation and redirect to dashboard
                    showAnimation();
                    setTimeout(() => {
                        hideAnimation();
                        showDashboard();
                    }, 3000);
                    
                } catch (error) {
                    showNotification('Account creation error: ' + getErrorMessage(error.code), 'error');
                }
            });

            // Logout
            document.getElementById('logoutBtn').addEventListener('click', () => {
                signOut(auth);
                showNotification('Logged out successfully', 'info');
            });

            // Navigation
            document.getElementById('showSignupLink').addEventListener('click', (e) => {
                e.preventDefault();
                showSignup();
            });
            
            document.getElementById('showLoginLink').addEventListener('click', (e) => {
                e.preventDefault();
                showLogin();
            });

            // Dashboard navigation
            document.getElementById('navDashboard').addEventListener('click', (e) => {
                e.preventDefault();
                showDashboard();
            });
            
            document.getElementById('navParties').addEventListener('click', (e) => {
                e.preventDefault();
                showParties();
            });
            
            document.getElementById('navElection').addEventListener('click', (e) => {
                e.preventDefault();
                showElectionCountdown();
            });
            
            document.getElementById('navProfile').addEventListener('click', (e) => {
                e.preventDefault();
                showProfile();
            });
            
            document.getElementById('navSettings').addEventListener('click', (e) => {
                e.preventDefault();
                showSettings();
            });

            // Theme settings
            document.getElementById('themeLight').addEventListener('click', () => setTheme('light'));
            document.getElementById('themeDark').addEventListener('click', () => setTheme('dark'));
            document.getElementById('themeBlue').addEventListener('click', () => setTheme('blue'));
            document.getElementById('themeGreen').addEventListener('click', () => setTheme('green'));

            // Search parties
            document.getElementById('searchParties').addEventListener('input', searchParties);
            
            // Create Party
            document.getElementById('createPartyBtn').addEventListener('click', () => {
                document.getElementById('createPartyModal').style.display = 'flex';
            });

            document.getElementById('closeCreateParty').addEventListener('click', () => {
                document.getElementById('createPartyModal').style.display = 'none';
            });

            document.getElementById('createPartyForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                await createNewParty();
            });

            // PM details
            document.getElementById('pmDetailsBtn').addEventListener('click', showPMDetails);
        }

        // Create New Party - FIXED VERSION
        async function createNewParty() {
            const partyName = document.getElementById('newPartyName').value;
            const partyDescription = document.getElementById('newPartyDescription').value;
            const partySymbol = document.getElementById('newPartySymbol').value || "ðŸ›ï¸";
            
            if (!partyName.trim()) {
                showNotification('Please enter a party name', 'error');
                return;
            }
            
            if (userData && userData.groupId) {
                showNotification('You are already in a party!', 'error');
                return;
            }
            
            try {
                // Create party document
                const partyRef = await addDoc(collection(db, "parties"), {
                    name: partyName,
                    description: partyDescription,
                    symbol: partySymbol,
                    leaderId: currentUser.uid,
                    leaderName: userData?.name || currentUser.email,
                    leaderEmail: currentUser.email,
                    memberCount: 1,
                    createdAt: serverTimestamp(),
                    mergeCount: 0,
                    totalVotes: 0,
                    isActive: true
                });
                
                // Update user document
                const userRef = doc(db, "users", currentUser.uid);
                await updateDoc(userRef, {
                    groupId: partyRef.id,
                    isLeader: true,
                    partyName: partyName,
                    joinedPartyAt: serverTimestamp()
                });
                
                // Update local user data
                userData.groupId = partyRef.id;
                userData.isLeader = true;
                userData.partyName = partyName;
                
                showNotification(`Party "${partyName}" created successfully!`, 'success');
                document.getElementById('createPartyModal').style.display = 'none';
                document.getElementById('createPartyForm').reset();
                
                // Reload data
                loadDashboardData();
                loadAllParties();
                updateProfileDisplay();
                
            } catch (error) {
                console.error("Error creating party:", error);
                showNotification('Error creating party: ' + error.message, 'error');
            }
        }

        // Page Navigation
        function showLogin() {
            hideAllPages();
            document.getElementById('loginPage').classList.add('active');
        }

        function showSignup() {
            hideAllPages();
            document.getElementById('signupPage').classList.add('active');
        }

        function showDashboard() {
            hideAllPages();
            document.getElementById('dashboardPage').classList.add('active');
            loadDashboardData();
        }

        function showParties() {
            hideAllPages();
            document.getElementById('partiesPage').classList.add('active');
            loadAllParties();
        }

        function showElectionCountdown() {
            hideAllPages();
            document.getElementById('electionPage').classList.add('active');
        }

        function showProfile() {
            hideAllPages();
            document.getElementById('profilePage').classList.add('active');
            updateProfileDisplay();
        }

        function showSettings() {
            hideAllPages();
            document.getElementById('settingsPage').classList.add('active');
        }

        function showPMDetails() {
            hideAllPages();
            document.getElementById('pmDetailsPage').classList.add('active');
            loadPMDetails();
        }

        function hideAllPages() {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
        }

        // Load Dashboard Data
        async function loadDashboardData() {
            try {
                // Load total parties count
                const partiesSnapshot = await getDocs(collection(db, "parties"));
                document.getElementById('totalPartiesCount').textContent = partiesSnapshot.size;
                
                // Load alone citizens count
                const usersQuery = query(collection(db, "users"), where("groupId", "==", null));
                const aloneUsersSnapshot = await getDocs(usersQuery);
                document.getElementById('aloneCitizensCount').textContent = aloneUsersSnapshot.size;
                
                // Load current PM
                const pmQuery = query(collection(db, "users"), where("isPM", "==", true));
                const pmSnapshot = await getDocs(pmQuery);
                let pmName = "Election in Progress";
                
                if (!pmSnapshot.empty) {
                    const pmData = pmSnapshot.docs[0].data();
                    pmName = pmData.name || pmData.email;
                }
                
                document.getElementById('currentPMName').textContent = pmName;
                
            } catch (error) {
                console.error("Error loading dashboard data:", error);
            }
        }

        // Load All Parties
        async function loadAllParties() {
            const partiesList = document.getElementById('partiesList');
            partiesList.innerHTML = '<div class="loading">Loading parties...</div>';
            
            try {
                const querySnapshot = await getDocs(collection(db, "parties"));
                allPartiesData = [];
                
                querySnapshot.forEach((doc) => {
                    const party = doc.data();
                    party.id = doc.id;
                    allPartiesData.push(party);
                });
                
                displayParties(allPartiesData);
                
            } catch (error) {
                console.error("Error loading parties:", error);
                partiesList.innerHTML = '<div class="error-state">Error loading parties</div>';
            }
        }

        function displayParties(parties) {
            const partiesList = document.getElementById('partiesList');
            partiesList.innerHTML = '';
            
            if (parties.length === 0) {
                partiesList.innerHTML = '<div class="empty-state">No parties found. Be the first to create one!</div>';
                return;
            }
            
            parties.forEach((party) => {
                const div = document.createElement('div');
                div.className = 'party-card';
                div.innerHTML = `
                    <div class="party-header">
                        <div class="party-badge">${party.symbol || party.name.substring(0, 2).toUpperCase()}</div>
                        <div class="party-info">
                            <h4>${party.name}</h4>
                            <p class="party-leader"><i class="fas fa-crown"></i> ${party.leaderName}</p>
                        </div>
                        <span class="member-count">${party.memberCount || 1} Members</span>
                    </div>
                    <p class="party-desc">${party.description || 'No description available'}</p>
                    <div class="party-stats">
                        <span><i class="fas fa-exchange-alt"></i> ${party.mergeCount || 0}/4 Merges</span>
                        <span><i class="fas fa-calendar"></i> ${formatDate(party.createdAt)}</span>
                    </div>
                    <div class="party-actions">
                        ${!userData || !userData.groupId ? `
                            <button class="btn-join" onclick="requestToJoin('${party.id}')">
                                <i class="fas fa-sign-in-alt"></i> Request to Join
                            </button>
                        ` : `
                            <button class="btn-join" disabled>
                                <i class="fas fa-check"></i> Already in a Party
                            </button>
                        `}
                        <button class="btn-view" onclick="viewPartyDetails('${party.id}')">
                            <i class="fas fa-eye"></i> View Details
                        </button>
                    </div>
                `;
                partiesList.appendChild(div);
            });
        }

        // Request to Join Party
        window.requestToJoin = async function(partyId) {
            if (!userData || userData.groupId) {
                showNotification('You are already in a party!', 'error');
                return;
            }
            
            const party = allPartiesData.find(p => p.id === partyId);
            if (!party) {
                showNotification('Party not found', 'error');
                return;
            }
            
            try {
                await addDoc(collection(db, "joinRequests"), {
                    partyId: partyId,
                    partyName: party.name,
                    userId: currentUser.uid,
                    userName: userData.name || currentUser.email,
                    userEmail: currentUser.email,
                    requestedAt: serverTimestamp(),
                    status: 'pending'
                });
                
                showNotification(`Join request sent to ${party.leaderName}!`, 'success');
                
            } catch (error) {
                console.error("Error sending join request:", error);
                showNotification('Error sending request', 'error');
            }
        };

        // View Party Details
        window.viewPartyDetails = function(partyId) {
            const party = allPartiesData.find(p => p.id === partyId);
            if (!party) {
                showNotification('Party not found', 'error');
                return;
            }
            
            showNotification(`Party: ${party.name}<br>Leader: ${party.leaderName}<br>Members: ${party.memberCount}`, 'info');
        };

        // Search Parties
        function searchParties() {
            const searchTerm = document.getElementById('searchParties').value.toLowerCase();
            if (!allPartiesData) return;
            
            if (!searchTerm) {
                displayParties(allPartiesData);
                return;
            }
            
            const filteredParties = allPartiesData.filter(party => 
                party.name.toLowerCase().includes(searchTerm) ||
                (party.description && party.description.toLowerCase().includes(searchTerm)) ||
                party.leaderName.toLowerCase().includes(searchTerm)
            );
            
            displayParties(filteredParties);
        }

        // Election Timer
        function initializeElectionTimer() {
            updateElectionTimer();
            setInterval(updateElectionTimer, 1000);
        }

        function updateElectionTimer() {
            const now = new Date();
            const diff = electionEndDate - now;
            
            if (diff <= 0) {
                electionEndDate = new Date();
                electionEndDate.setDate(electionEndDate.getDate() + 30);
                return;
            }
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            document.getElementById('electionDays').textContent = days;
            document.getElementById('electionHours').textContent = hours.toString().padStart(2, '0');
            document.getElementById('electionMinutes').textContent = minutes.toString().padStart(2, '0');
            document.getElementById('electionSeconds').textContent = seconds.toString().padStart(2, '0');
            
            document.getElementById('electionDays2').textContent = days;
            document.getElementById('electionHours2').textContent = hours.toString().padStart(2, '0');
            document.getElementById('electionMinutes2').textContent = minutes.toString().padStart(2, '0');
            document.getElementById('electionSeconds2').textContent = seconds.toString().padStart(2, '0');
        }

        // Load PM Details
        async function loadPMDetails() {
            const pmDetailsContent = document.getElementById('pmDetailsContent');
            pmDetailsContent.innerHTML = '<div class="loading">Loading PM details...</div>';
            
            try {
                const pmQuery = query(collection(db, "users"), where("isPM", "==", true));
                const pmSnapshot = await getDocs(pmQuery);
                
                if (pmSnapshot.empty) {
                    pmDetailsContent.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-crown" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                            <h3>No Prime Minister Elected</h3>
                            <p>Elections are in progress. Check the countdown for next election.</p>
                        </div>
                    `;
                    return;
                }
                
                const pmData = pmSnapshot.docs[0].data();
                pmDetailsContent.innerHTML = `
                    <div class="pm-card">
                        <div class="pm-avatar" style="background: linear-gradient(135deg, var(--primary), var(--secondary));">
                            <i class="fas fa-crown"></i>
                        </div>
                        <h3>${pmData.name || 'Prime Minister'}</h3>
                        <p class="pm-email">${pmData.email}</p>
                        <div class="pm-stats">
                            <div class="pm-stat">
                                <span class="stat-label">Term Started</span>
                                <span class="stat-value">${formatDate(pmData.pmSince) || 'Recently'}</span>
                            </div>
                            <div class="pm-stat">
                                <span class="stat-label">Trust Score</span>
                                <span class="stat-value">${pmData.trustScore || 50}</span>
                            </div>
                            <div class="pm-stat">
                                <span class="stat-label">Party</span>
                                <span class="stat-value">${pmData.partyName || 'Independent'}</span>
                            </div>
                        </div>
                        <div class="pm-policies">
                            <h4>Current Policies</h4>
                            <p>${pmData.policies || 'No active policies announced yet'}</p>
                        </div>
                    </div>
                `;
                
            } catch (error) {
                console.error("Error loading PM details:", error);
                pmDetailsContent.innerHTML = '<div class="error-state">Error loading PM details</div>';
            }
        }

        // Update Profile Display
        function updateProfileDisplay() {
            if (userData) {
                document.getElementById('profileUserName').textContent = userData.name || 'Citizen';
                document.getElementById('profileUserEmail').textContent = userData.email;
                document.getElementById('profilePartyStatus').textContent = userData.groupId ? 'Party Member' : 'Independent';
                
                if (userData.createdAt) {
                    try {
                        const date = userData.createdAt.toDate();
                        document.getElementById('profileJoinDate').textContent = date.toLocaleDateString('en-US', { 
                            year: 'numeric', 
                            month: 'long', 
                            day: 'numeric' 
                        });
                    } catch (e) {
                        document.getElementById('profileJoinDate').textContent = 'Recently';
                    }
                } else {
                    document.getElementById('profileJoinDate').textContent = 'Recently';
                }
            }
        }

        // Helper Functions
        function formatDate(timestamp) {
            if (!timestamp) return 'Recent';
            try {
                const date = timestamp.toDate();
                return date.toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric' 
                });
            } catch (e) {
                return 'Recent';
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
                <button onclick="this.parentElement.remove()"><i class="fas fa-times"></i></button>
            `;
            document.getElementById('notificationContainer').appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        function getErrorMessage(errorCode) {
            const messages = {
                'auth/invalid-credential': 'Wrong email or password',
                'auth/user-not-found': 'User not found',
                'auth/wrong-password': 'Wrong password',
                'auth/email-already-in-use': 'Email already registered',
                'auth/weak-password': 'Weak password (min 6 characters)',
                'auth/invalid-email': 'Invalid email',
                'auth/network-request-failed': 'Network error'
            };
            return messages[errorCode] || 'An error occurred';
        }

        // Global Variables
        let allPartiesData = [];
    </script>

    <style>
        :root {
            --primary: #1a237e;
            --secondary: #4a148c;
            --accent: #00bcd4;
            --light: #f5f7fa;
            --dark: #1a1a2e;
            --success: #00c853;
            --danger: #d32f2f;
            --warning: #ff9800;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --primary: #0d1b2a;
            --secondary: #415a77;
            --accent: #4cc9f0;
            --light: #1b263b;
            --dark: #0a0a0f;
        }

        [data-theme="blue"] {
            --primary: #1565c0;
            --secondary: #0277bd;
            --accent: #29b6f6;
            --light: #e3f2fd;
            --dark: #0d47a1;
        }

        [data-theme="green"] {
            --primary: #2e7d32;
            --secondary: #388e3c;
            --accent: #66bb6a;
            --light: #e8f5e9;
            --dark: #1b5e20;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--light) 0%, #e0e0e0 100%);
            color: var(--dark);
            min-height: 100vh;
            transition: all 0.3s ease;
            overflow-x: hidden;
        }

        .history-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(26, 35, 126, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(74, 20, 140, 0.1) 0%, transparent 50%),
                linear-gradient(45deg, rgba(255, 215, 0, 0.05) 0%, transparent 50%);
            z-index: -2;
            opacity: 0.3;
        }

        .history-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><circle cx="50" cy="50" r="2" fill="%231a237e" opacity="0.1"/></svg>');
            background-size: 100px 100px;
            z-index: -1;
            opacity: 0.2;
        }

        /* India Gate Animation */
        #indiaGateAnimation {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to top, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
            display: none;
            justify-content: center;
            align-items: flex-end;
            z-index: 9998;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            pointer-events: none;
        }

        .india-gate-content {
            text-align: center;
            padding-bottom: 100px;
            max-width: 800px;
            margin: 0 auto;
        }

        .india-gate-icon {
            font-size: 6rem;
            color: var(--primary);
            margin-bottom: 1rem;
            text-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* Welcome Animation */
        #welcomeAnimation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            animation: fadeOut 3s ease-in-out forwards;
        }

        .animation-content {
            text-align: center;
            color: white;
        }

        #animationLogo {
            font-size: 5rem;
            margin-bottom: 2rem;
            opacity: 0;
            transform: scale(0.5);
            color: white;
        }

        #animationLogo.animate {
            animation: logoAnimation 3s ease-in-out;
        }

        @keyframes logoAnimation {
            0% {
                opacity: 0;
                transform: scale(0.5) rotate(-180deg);
                filter: blur(10px);
            }
            50% {
                opacity: 1;
                transform: scale(1.2) rotate(0deg);
                filter: blur(0);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
                filter: blur(0);
            }
        }

        @keyframes fadeOut {
            0% { opacity: 1; }
            70% { opacity: 1; }
            100% { opacity: 0; visibility: hidden; }
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 1rem 0;
            box-shadow: var(--shadow);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
        }

        .logo-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
            box-shadow: 0 4px 15px rgba(26, 35, 126, 0.3);
        }

        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-text small {
            color: #666;
            font-size: 0.9rem;
        }

        /* Navigation */
        .nav {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .nav-link {
            padding: 0.8rem 1.2rem;
            color: var(--dark);
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
            background: linear-gradient(135deg, rgba(26, 35, 126, 0.1), rgba(74, 20, 140, 0.1));
        }

        .nav-link:hover {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .nav-link.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        /* Main Content */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Pages */
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Dashboard Stats */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.2rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            margin: 0 auto 0.8rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            box-shadow: 0 5px 15px rgba(26, 35, 126, 0.3);
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0.3rem 0;
            line-height: 1;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .stat-btn {
            margin-top: 0.5rem;
            padding: 0.4rem 0.8rem;
            background: linear-gradient(135deg, var(--accent), var(--secondary));
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .stat-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }

        /* Parties Page */
        .search-container {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .search-box {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 1rem 1.5rem 1rem 3rem;
            border: 2px solid rgba(26, 35, 126, 0.1);
            border-radius: 12px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20' fill='%231a237e'%3E%3Cpath d='M12.9 14.32a8 8 0 111.41-1.41l5.35 5.33-1.42 1.42-5.33-5.34zM8 14A6 6 0 108 2a6 6 0 000 12z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: 1rem center;
            background-size: 20px;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 35, 126, 0.1);
            background-color: white;
        }

        .parties-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.2rem;
        }

        .party-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 1.2rem;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-height: 220px;
            display: flex;
            flex-direction: column;
        }

        .party-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .party-header {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 0.8rem;
        }

        .party-badge {
            width: 50px;
            height: 50px;
            min-width: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.3rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .party-info {
            flex: 1;
            min-width: 0;
        }

        .party-info h4 {
            margin: 0 0 0.2rem;
            color: var(--dark);
            font-size: 1.2rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .party-leader {
            color: #666;
            font-size: 0.85rem;
            margin: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .member-count {
            background: linear-gradient(135deg, var(--accent), var(--secondary));
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 15px;
            font-weight: 600;
            font-size: 0.8rem;
            white-space: nowrap;
        }

        .party-desc {
            color: #666;
            margin-bottom: 0.8rem;
            line-height: 1.4;
            font-size: 0.9rem;
            flex: 1;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .party-stats {
            display: flex;
            gap: 0.8rem;
            margin-bottom: 0.8rem;
            font-size: 0.85rem;
            color: #888;
            flex-wrap: wrap;
        }

        .party-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: auto;
        }

        .btn-join, .btn-view {
            flex: 1;
            padding: 0.6rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.4rem;
            min-height: 36px;
        }

        .btn-join {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-join:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(26, 35, 126, 0.3);
        }

        .btn-join:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-view {
            background: rgba(0, 0, 0, 0.05);
            color: var(--dark);
        }

        .btn-view:hover {
            background: rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        /* Election Countdown */
        .election-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem auto;
            max-width: 800px;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .countdown {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .countdown-item {
            text-align: center;
            min-width: 100px;
        }

        .countdown-value {
            display: block;
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
            text-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }

        .countdown-label {
            color: #666;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            font-weight: 500;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1001;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: modalSlide 0.3s ease;
        }

        @keyframes modalSlide {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(0, 0, 0, 0.1);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(0, 0, 0, 0.1);
            color: var(--danger);
        }

        /* Settings */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .theme-option {
            padding: 1.5rem;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: var(--shadow);
            border: 2px solid transparent;
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .theme-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
            border-color: var(--primary);
        }

        .theme-light { background: linear-gradient(135deg, #f5f7fa, #c3cfe2); }
        .theme-dark { background: linear-gradient(135deg, #2c3e50, #4a235a); color: white; }
        .theme-blue { background: linear-gradient(135deg, #2193b0, #6dd5ed); }
        .theme-green { background: linear-gradient(135deg, #11998e, #38ef7d); }

        /* PM Details */
        .pm-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            max-width: 600px;
            margin: 2rem auto;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .pm-avatar {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            color: white;
            font-size: 2.5rem;
            box-shadow: 0 10px 30px rgba(26, 35, 126, 0.3);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 35, 126, 0.1);
            background: white;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(26, 35, 126, 0.3);
        }

        .btn-block {
            width: 100%;
        }

        /* Page Headers */
        .page-header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .page-title {
            font-size: 2.2rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .page-subtitle {
            color: #666;
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Loading States */
        .loading, .empty-state, .error-state {
            text-align: center;
            padding: 3rem;
            color: #666;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 16px;
            margin: 2rem 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Notifications */
        .notification-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 1000;
        }

        .notification {
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            animation: slideIn 0.3s ease;
            min-width: 300px;
            border-left: 4px solid var(--primary);
            max-width: 350px;
        }

        .notification.success {
            border-left-color: var(--success);
        }

        .notification.error {
            border-left-color: var(--danger);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }
            
            .nav {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .dashboard-stats {
                grid-template-columns: 1fr;
            }
            
            .parties-grid {
                grid-template-columns: 1fr;
            }
            
            .countdown {
                gap: 1rem;
            }
            
            .countdown-value {
                font-size: 2.5rem;
            }
            
            .countdown-item {
                min-width: 80px;
            }
        }
    </style>
</head>
<body data-theme="light">
    <!-- Historical Background -->
    <div class="history-background"></div>
    <div class="history-pattern"></div>

    <!-- India Gate Animation -->
    <div id="indiaGateAnimation">
        <div class="india-gate-content">
            <div class="india-gate-icon">
                <i class="fas fa-monument"></i>
            </div>
            <h2 style="color: var(--primary); margin-bottom: 0.5rem; font-size: 2.5rem;">India Gate</h2>
            <p style="color: #666; font-size: 1.1rem; max-width: 600px; margin: 0 auto 1rem;">
                A symbol of India's rich history and democratic values.<br>
                Standing tall as a reminder of sacrifice and unity.
            </p>
            <p style="color: var(--secondary); font-weight: 500;">
                "Where history meets democracy"
            </p>
        </div>
    </div>

    <!-- Welcome Animation -->
    <div id="welcomeAnimation">
        <div class="animation-content">
            <div id="animationLogo">
                <i class="fas fa-democracy"></i>
            </div>
            <h2 style="font-size: 3rem; margin-bottom: 1rem;">DELHI SIM</h2>
            <p style="font-size: 1.2rem; opacity: 0.9;">Digital Democracy Platform</p>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">
                <div class="logo-icon">
                    <i class="fas fa-democracy"></i>
                </div>
                <div class="logo-text">
                    <h1>DELHI SIM</h1>
                    <small>Digital Democracy</small>
                </div>
            </a>

            <nav class="nav">
                <a href="#" class="nav-link" id="navDashboard"><i class="fas fa-home"></i> Home</a>
                <a href="#" class="nav-link" id="navParties"><i class="fas fa-users"></i> Parties</a>
                <a href="#" class="nav-link" id="navElection"><i class="fas fa-vote-yea"></i> Election</a>
                <a href="#" class="nav-link" id="navProfile"><i class="fas fa-user"></i> Profile</a>
                <a href="#" class="nav-link" id="navSettings"><i class="fas fa-cog"></i> Settings</a>
                <button id="logoutBtn" class="nav-link" style="background: none; border: none; cursor: pointer;">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <!-- Login Page -->
        <div id="loginPage" class="page active">
            <div class="page-header">
                <h1 class="page-title">Welcome to DELHI SIM</h1>
                <p class="page-subtitle">Digital Democracy Platform - Login to continue</p>
            </div>

            <div style="max-width: 400px; margin: 0 auto; background: rgba(255, 255, 255, 0.95); padding: 2rem; border-radius: 20px; box-shadow: var(--shadow); border: 1px solid rgba(255, 255, 255, 0.2);">
                <form id="loginForm">
                    <div style="margin-bottom: 1.5rem;">
                        <input type="email" id="loginEmail" class="form-control" placeholder="Email Address" required>
                    </div>
                    <div style="margin-bottom: 1.5rem;">
                        <input type="password" id="loginPassword" class="form-control" placeholder="Password" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                </form>
                <div style="text-align: center; margin-top: 1.5rem;">
                    <p style="color: #666;">Don't have an account? 
                        <a href="#" id="showSignupLink" style="color: var(--primary); text-decoration: none; font-weight: 600;">
                            Create Account
                        </a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Signup Page -->
        <div id="signupPage" class="page">
            <div class="page-header">
                <h1 class="page-title">Create Account</h1>
                <p class="page-subtitle">Join the digital democracy movement</p>
            </div>

            <div style="max-width: 400px; margin: 0 auto; background: rgba(255, 255, 255, 0.95); padding: 2rem; border-radius: 20px; box-shadow: var(--shadow); border: 1px solid rgba(255, 255, 255, 0.2);">
                <form id="signupForm">
                    <div style="margin-bottom: 1.5rem;">
                        <input type="text" id="signupName" class="form-control" placeholder="Full Name" required>
                    </div>
                    <div style="margin-bottom: 1.5rem;">
                        <input type="email" id="signupEmail" class="form-control" placeholder="Email Address" required>
                    </div>
                    <div style="margin-bottom: 1.5rem;">
                        <input type="password" id="signupPassword" class="form-control" placeholder="Password (min 6 characters)" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                </form>
                <div style="text-align: center; margin-top: 1.5rem;">
                    <p style="color: #666;">Already have an account? 
                        <a href="#" id="showLoginLink" style="color: var(--primary); text-decoration: none; font-weight: 600;">
                            Login
                        </a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Home Page -->
        <div id="dashboardPage" class="page">
            <div class="page-header">
                <h1 class="page-title">Digital Democracy Platform</h1>
                <p class="page-subtitle">Real-time political simulation with complete transparency</p>
            </div>

            <div class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-value" id="totalPartiesCount">0</div>
                    <div class="stat-label">Active Parties</div>
                    <button class="stat-btn" onclick="showParties()">
                        <i class="fas fa-eye"></i> View All
                    </button>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="stat-value" id="aloneCitizensCount">0</div>
                    <div class="stat-label">Independent Citizens</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="stat-value" id="currentPMName">-</div>
                    <div class="stat-label">Current Prime Minister</div>
                    <button id="pmDetailsBtn" class="stat-btn">
                        <i class="fas fa-info-circle"></i> View Details
                    </button>
                </div>
            </div>

            <div class="election-card">
                <h2 style="color: var(--primary); margin-bottom: 0.5rem;">Next Election Countdown</h2>
                <p style="color: #666; margin-bottom: 2rem;">Time until next monthly election cycle</p>
                <div class="countdown">
                    <div class="countdown-item">
                        <span class="countdown-value" id="electionDays">30</span>
                        <span class="countdown-label">Days</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="electionHours">23</span>
                        <span class="countdown-label">Hours</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="electionMinutes">59</span>
                        <span class="countdown-label">Minutes</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="electionSeconds">59</span>
                        <span class="countdown-label">Seconds</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Parties Page -->
        <div id="partiesPage" class="page">
            <div class="page-header">
                <h1 class="page-title">Political Parties</h1>
                <p class="page-subtitle">Browse and join political parties. Each party can have maximum 4 merges.</p>
            </div>

            <div class="search-container">
                <div class="search-box">
                    <input type="text" id="searchParties" placeholder="Search parties by name, leader, or description...">
                </div>
                <div style="text-align: center; margin-top: 1.5rem;">
                    <button id="createPartyBtn" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Create New Party
                    </button>
                </div>
            </div>

            <div id="partiesList" class="parties-grid">
                <!-- Parties will be loaded here -->
            </div>
        </div>

        <!-- Election Page -->
        <div id="electionPage" class="page">
            <div class="page-header">
                <h1 class="page-title">Election Information</h1>
                <p class="page-subtitle">Monthly democratic elections ensure power remains with the people</p>
            </div>

            <div class="election-card">
                <h2 style="color: var(--primary); margin-bottom: 0.5rem; font-size: 2rem;">Next Election Countdown</h2>
                <p style="color: #666; margin-bottom: 2rem; font-size: 1.1rem;">Monthly election cycle resets every 30 days</p>
                
                <div class="countdown">
                    <div class="countdown-item">
                        <span class="countdown-value" id="electionDays2">30</span>
                        <span class="countdown-label">Days</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="electionHours2">23</span>
                        <span class="countdown-label">Hours</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="electionMinutes2">59</span>
                        <span class="countdown-label">Minutes</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="electionSeconds2">59</span>
                        <span class="countdown-label">Seconds</span>
                    </div>
                </div>

                <div style="margin-top: 3rem; padding: 2rem; background: rgba(0, 0, 0, 0.03); border-radius: 15px;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">Election Rules</h3>
                    <ul style="text-align: left; color: #666; line-height: 1.6; padding-left: 1.5rem;">
                        <li>Elections are held monthly every 30 days</li>
                        <li>All citizens have equal voting power</li>
                        <li>Voting is secret and anonymous</li>
                        <li>Prime Minister term is exactly 30 days</li>
                        <li>No re-election guarantees</li>
                        <li>Results are calculated automatically and transparently</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Profile Page -->
        <div id="profilePage" class="page">
            <div class="page-header">
                <h1 class="page-title">Your Profile</h1>
                <p class="page-subtitle">View and manage your account information</p>
            </div>

            <div class="pm-card">
                <div class="pm-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <h2 style="color: var(--primary); margin-bottom: 0.5rem;" id="profileUserName">Citizen Profile</h2>
                <p style="color: #666; margin-bottom: 2rem;" id="profileUserEmail">Loading...</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 2rem 0;">
                    <div style="padding: 1.5rem; background: rgba(0, 0, 0, 0.03); border-radius: 12px;">
                        <p style="color: #666; font-size: 0.9rem;">Account Status</p>
                        <p style="font-size: 1.2rem; font-weight: 600; color: var(--primary);">Active Citizen</p>
                    </div>
                    <div style="padding: 1.5rem; background: rgba(0, 0, 0, 0.03); border-radius: 12px;">
                        <p style="color: #666; font-size: 0.9rem;">Party Membership</p>
                        <p style="font-size: 1.2rem; font-weight: 600; color: var(--primary);" id="profilePartyStatus">No Party</p>
                    </div>
                    <div style="padding: 1.5rem; background: rgba(0, 0, 0, 0.03); border-radius: 12px;">
                        <p style="color: #666; font-size: 0.9rem;">Member Since</p>
                        <p style="font-size: 1.2rem; font-weight: 600; color: var(--primary);" id="profileJoinDate">Loading...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settingsPage" class="page">
            <div class="page-header">
                <h1 class="page-title">Settings</h1>
                <p class="page-subtitle">Customize your DELHI SIM experience</p>
            </div>

            <div class="settings-grid">
                <div class="theme-option theme-light" id="themeLight">
                    <i class="fas fa-sun" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                    <h3 style="margin-bottom: 0.5rem;">Light Theme</h3>
                    <p style="color: #666; font-size: 0.9rem;">Clean and bright interface</p>
                </div>
                <div class="theme-option theme-dark" id="themeDark">
                    <i class="fas fa-moon" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                    <h3 style="margin-bottom: 0.5rem;">Dark Theme</h3>
                    <p style="opacity: 0.9; font-size: 0.9rem;">Easy on the eyes, reduces glare</p>
                </div>
                <div class="theme-option theme-blue" id="themeBlue">
                    <i class="fas fa-water" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                    <h3 style="margin-bottom: 0.5rem;">Blue Theme</h3>
                    <p style="opacity: 0.9; font-size: 0.9rem;">Professional blue gradient</p>
                </div>
                <div class="theme-option theme-green" id="themeGreen">
                    <i class="fas fa-leaf" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                    <h3 style="margin-bottom: 0.5rem;">Green Theme</h3>
                    <p style="opacity: 0.9; font-size: 0.9rem;">Fresh and vibrant green palette</p>
                </div>
            </div>
        </div>

        <!-- PM Details Page -->
        <div id="pmDetailsPage" class="page">
            <div class="page-header">
                <h1 class="page-title">Prime Minister Details</h1>
                <p class="page-subtitle">Current elected Prime Minister information</p>
            </div>
            
            <div id="pmDetailsContent">
                <!-- PM details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Create Party Modal -->
    <div id="createPartyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="color: var(--primary);">Create New Party</h2>
                <button class="modal-close" id="closeCreateParty">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="createPartyForm">
                <div class="form-group">
                    <label class="form-label">Party Name *</label>
                    <input type="text" id="newPartyName" class="form-control" placeholder="Enter party name" required maxlength="50">
                </div>
                <div class="form-group">
                    <label class="form-label">Party Symbol (Optional)</label>
                    <input type="text" id="newPartySymbol" class="form-control" placeholder="e.g., ðŸŒ¸, ðŸ¦š, ðŸ•‰ï¸" maxlength="5">
                    <small style="color: #666; font-size: 0.85rem;">You can use emojis or 2-3 letters</small>
                </div>
                <div class="form-group">
                    <label class="form-label">Party Description *</label>
                    <textarea id="newPartyDescription" class="form-control" placeholder="Describe your party's ideology and goals..." rows="4" required maxlength="500"></textarea>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-users"></i> Create Party
                </button>
            </form>
        </div>
    </div>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target.id === 'createPartyModal') {
                document.getElementById('createPartyModal').style.display = 'none';
            }
        });
    </script>
</body>
</html>
